{"version":3,"file":"index.umd.js","sources":["../src/constant.ts","../src/useEffectTimeout.ts","../src/webPlaybackSDKReady.tsx","../src/spotifyPlayer.tsx","../src/device.tsx","../src/errorState.tsx","../src/playbackState.tsx","../src/webPlaybackSDK.tsx"],"sourcesContent":["export const MUST_BE_WRAPPED_MESSAGE =\n  \"Component must be wrapped with WebPlaybackSDK.\";\n\nexport const SPOTIFY_WEB_PLAYBACK_SDK_URL = \"https://sdk.scdn.co/spotify-player.js\";\n","import { useEffect } from \"react\";\n\nexport function useEffectTimeout(\n  effect: React.EffectCallback,\n  deps: React.DependencyList,\n  timeout: number = 1000,\n) {\n  useEffect(() => {\n    const timeoutId = setTimeout(effect, timeout);\n\n    return () => clearTimeout(timeoutId);\n  }, deps);\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\n\nconst WebPlaybackSDKReadyContext = createContext<boolean | undefined>(undefined);\n\nexport const WebPlaybackSDKReadyProvider: React.FC = ({ children }) => {\n  const [webPlaybackSDKReady, setWebPlaybackSDKReady] = useState(false);\n\n  useEffect(() => {\n    window.onSpotifyWebPlaybackSDKReady = () => {\n      setWebPlaybackSDKReady(true);\n    };\n  }, []);\n\n  return (\n    <WebPlaybackSDKReadyContext.Provider value={webPlaybackSDKReady}>\n      {children}\n    </WebPlaybackSDKReadyContext.Provider>\n  );\n};\n\nexport function useWebPlaybackSDKReady() {\n  const value = useContext(WebPlaybackSDKReadyContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, {\n  createContext,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useEffectTimeout } from \"./useEffectTimeout\";\nimport { useWebPlaybackSDKReady } from \"./webPlaybackSDKReady\";\n\nconst PlayerContext = createContext<Spotify.Player | null | undefined>(undefined);\n\ntype ProviderProps = {\n  deviceName: Spotify.PlayerInit[\"name\"];\n  getOAuthToken: Spotify.PlayerInit[\"getOAuthToken\"];\n  volume?: Spotify.PlayerInit[\"volume\"];\n  connectOnInitialized: boolean;\n};\n\nexport const SpotifyPlayerProvider: React.FC<ProviderProps> = ({\n  children,\n  deviceName,\n  getOAuthToken,\n  volume,\n  connectOnInitialized,\n}) => {\n  const [player, setPlayer] = useState<Spotify.Player | null>(null);\n  const webPlaybackSDKReady = useWebPlaybackSDKReady();\n\n  // create Spotify.Player instance.\n  useEffect(\n    () => {\n      if (webPlaybackSDKReady) {\n        const player = new Spotify.Player({\n          name: deviceName,\n          getOAuthToken: getOAuthToken,\n          volume: volume,\n        });\n\n        setPlayer(player);\n\n        if (connectOnInitialized) {\n          player.connect();\n        }\n\n        return () => player.disconnect();\n      }\n    },\n    // `deviceName` and `volume` are intentionally not passed.\n    // When they are changed, they will be applied with the following useUpdateEffect.\n    [getOAuthToken, connectOnInitialized, webPlaybackSDKReady],\n  );\n\n  // The first effect is ignored.\n  // Because the first `deviceName` will be passed to Spotify.Player constructor.\n  useEffectTimeout(() => {\n    player?.setName(deviceName);\n  }, [deviceName]);\n\n  // The first effect is ignored.\n  // Because the first `volume` will be passed to Spotify.Player constructor.\n  useEffect(() => {\n    volume !== undefined && player?.setVolume(volume);\n  }, [volume]);\n\n  return <PlayerContext.Provider value={player} children={children} />;\n};\n\nexport type SpotifyPlayer = Omit<\n  Spotify.Player,\n  | \"addListener\"\n  | \"on\"\n  | \"removeListener\"\n  | \"setName\"\n  | \"setVolume\"\n  | \"_options\"\n  | \"getVolume\"\n>;\n\nexport function useSpotifyPlayer(): SpotifyPlayer | null {\n  const value = useContext(PlayerContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  const player = useMemo<SpotifyPlayer | null>(() => {\n    if (value === null) return null;\n\n    return {\n      connect: () => value.connect(),\n      disconnect: () => value.disconnect(),\n      getCurrentState: () => value.getCurrentState(),\n      nextTrack: () => value.nextTrack(),\n      pause: () => value.pause(),\n      previousTrack: () => value.previousTrack(),\n      resume: () => value.resume(),\n      seek: pos_ms => value.seek(pos_ms),\n      togglePlay: () => value.togglePlay(),\n    };\n  }, [value]);\n\n  return player;\n}\n\nexport function useSpotifyPlayerRawInstance() {\n  const value = useContext(PlayerContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nexport type PlayerDevice = Spotify.WebPlaybackInstance & {\n  status: \"ready\" | \"not_ready\";\n};\n\nconst DeviceContext = createContext<PlayerDevice | null | undefined>(undefined);\n\nexport const DeviceProvider: React.FC = ({ children }) => {\n  const [device, setDevice] = useState<PlayerDevice | null>(null);\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const ready = (device: Spotify.WebPlaybackInstance) => {\n      setDevice({ ...device, status: \"ready\" });\n    };\n\n    const notReady = (device: Spotify.WebPlaybackInstance) => {\n      setDevice({ ...device, status: \"not_ready\" });\n    };\n\n    player.addListener(\"ready\", ready);\n    player.addListener(\"not_ready\", notReady);\n\n    return () => {\n      player.removeListener(\"ready\", ready);\n      player.removeListener(\"not_ready\", notReady);\n    };\n  }, [player]);\n\n  return <DeviceContext.Provider value={device} children={children} />;\n};\n\nexport function usePlayerDevice() {\n  const value = useContext(DeviceContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nexport type ErrorState = Spotify.Error & { type: Spotify.ErrorTypes };\n\nconst ErrorStateContext = createContext<ErrorState | null | undefined>(undefined);\n\nexport const ErrorStateProvider: React.FC = ({ children }) => {\n  const [errorState, setErrorState] = useState<ErrorState | null>(null);\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const onInitializationError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"initialization_error\" });\n    };\n\n    const onAuthenticationError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"authentication_error\" });\n    };\n\n    const onAccountError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"account_error\" });\n    };\n\n    const onPlaybackError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"playback_error\" });\n    };\n\n    player.addListener(\"initialization_error\", onInitializationError);\n    player.addListener(\"authentication_error\", onAuthenticationError);\n    player.addListener(\"account_error\", onAccountError);\n    player.addListener(\"playback_error\", onPlaybackError);\n\n    return () => {\n      player.removeListener(\"initialization_error\", onInitializationError);\n      player.removeListener(\"authentication_error\", onAuthenticationError);\n      player.removeListener(\"account_error\", onAccountError);\n      player.removeListener(\"playback_error\", onPlaybackError);\n    };\n  }, [player]);\n\n  return <ErrorStateContext.Provider value={errorState} children={children} />;\n};\n\nexport function useErrorState() {\n  const value = useContext(ErrorStateContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nconst PlaybackStateContext = createContext<Spotify.PlaybackState | null | undefined>(\n  undefined,\n);\n\nexport const PlaybackStateProvider: React.FC = ({ children }) => {\n  const [playbackState, setPlaybackState] = useState<Spotify.PlaybackState | null>(\n    null,\n  );\n\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const playerStateChanged = (state: Spotify.PlaybackState) => {\n      setPlaybackState(state);\n    };\n\n    player.addListener(\"player_state_changed\", playerStateChanged);\n\n    return () => player.removeListener(\"player_state_changed\", playerStateChanged);\n  }, [player]);\n\n  return <PlaybackStateContext.Provider value={playbackState} children={children} />;\n};\n\nexport function usePlaybackState(interval?: false): Spotify.PlaybackState | null;\nexport function usePlaybackState(\n  interval: true,\n  durationMS?: number,\n): Spotify.PlaybackState | null;\nexport function usePlaybackState(\n  interval?: boolean,\n  durationMS = 1000,\n): Spotify.PlaybackState | null {\n  const fromContext = useContext(PlaybackStateContext);\n\n  if (fromContext === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  const [playbackState, setPlaybackState] = useState(fromContext);\n\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => setPlaybackState(fromContext), [fromContext]);\n\n  const playbackStateIsNull = playbackState === null;\n  useEffect(() => {\n    if (!interval) return;\n    if (player === null) return;\n    if (playbackStateIsNull) return;\n\n    if (playbackState!.paused) return;\n\n    const intervalId = window.setInterval(async () => {\n      const newState = await player.getCurrentState();\n      setPlaybackState(newState);\n    }, durationMS);\n\n    return () => window.clearInterval(intervalId);\n  }, [interval, player, playbackStateIsNull, playbackState?.paused, durationMS]);\n\n  return playbackState;\n}\n","import React, { useEffect } from \"react\";\nimport { SPOTIFY_WEB_PLAYBACK_SDK_URL } from \"./constant\";\nimport { DeviceProvider } from \"./device\";\nimport { ErrorStateProvider } from \"./errorState\";\nimport { PlaybackStateProvider } from \"./playbackState\";\nimport { SpotifyPlayerProvider } from \"./spotifyPlayer\";\nimport { WebPlaybackSDKReadyProvider } from \"./webPlaybackSDKReady\";\n\nexport type WebPlaybackSDKProps = {\n  deviceName: Spotify.PlayerInit[\"name\"];\n  getOAuthToken: Spotify.PlayerInit[\"getOAuthToken\"];\n  volume?: Spotify.PlayerInit[\"volume\"];\n  connectOnInitialized?: boolean;\n};\n\nexport const WebPlaybackSDK: React.FC<WebPlaybackSDKProps> = ({\n  children,\n  deviceName,\n  getOAuthToken,\n  volume,\n  connectOnInitialized = true,\n}) => {\n  useEffect(() => {\n    // load Web Playback SDK.\n    const script = document.createElement(\"script\");\n    script.src = SPOTIFY_WEB_PLAYBACK_SDK_URL;\n    document.body.appendChild(script);\n\n    return () => {\n      document.body.removeChild(script);\n    };\n  }, []);\n\n  return (\n    <WebPlaybackSDKReadyProvider>\n      <SpotifyPlayerProvider\n        deviceName={deviceName}\n        getOAuthToken={getOAuthToken}\n        volume={volume}\n        connectOnInitialized={connectOnInitialized}>\n        <PlaybackStateProvider>\n          <DeviceProvider>\n            <ErrorStateProvider>{children}</ErrorStateProvider>\n          </DeviceProvider>\n        </PlaybackStateProvider>\n      </SpotifyPlayerProvider>\n    </WebPlaybackSDKReadyProvider>\n  );\n};\n"],"names":["MUST_BE_WRAPPED_MESSAGE","SPOTIFY_WEB_PLAYBACK_SDK_URL","useEffectTimeout","effect","deps","timeout","useEffect","timeoutId","setTimeout","clearTimeout","WebPlaybackSDKReadyContext","createContext","undefined","WebPlaybackSDKReadyProvider","children","useState","webPlaybackSDKReady","setWebPlaybackSDKReady","window","onSpotifyWebPlaybackSDKReady","React","Provider","value","useWebPlaybackSDKReady","useContext","Error","PlayerContext","SpotifyPlayerProvider","deviceName","getOAuthToken","volume","connectOnInitialized","player","setPlayer","Spotify","Player","name","connect","disconnect","setName","setVolume","useSpotifyPlayer","useMemo","getCurrentState","nextTrack","pause","previousTrack","resume","seek","pos_ms","togglePlay","useSpotifyPlayerRawInstance","DeviceContext","DeviceProvider","device","setDevice","ready","status","notReady","addListener","removeListener","usePlayerDevice","ErrorStateContext","ErrorStateProvider","errorState","setErrorState","onInitializationError","error","type","onAuthenticationError","onAccountError","onPlaybackError","useErrorState","PlaybackStateContext","PlaybackStateProvider","playbackState","setPlaybackState","playerStateChanged","state","usePlaybackState","interval","durationMS","fromContext","playbackStateIsNull","paused","intervalId","setInterval","newState","clearInterval","WebPlaybackSDK","script","document","createElement","src","body","appendChild","removeChild"],"mappings":"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"}