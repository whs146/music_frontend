{"version":3,"file":"index.js","sources":["../src/constant.ts","../src/useEffectTimeout.ts","../src/webPlaybackSDKReady.tsx","../src/spotifyPlayer.tsx","../src/device.tsx","../src/errorState.tsx","../src/playbackState.tsx","../src/webPlaybackSDK.tsx"],"sourcesContent":["export const MUST_BE_WRAPPED_MESSAGE =\n  \"Component must be wrapped with WebPlaybackSDK.\";\n\nexport const SPOTIFY_WEB_PLAYBACK_SDK_URL = \"https://sdk.scdn.co/spotify-player.js\";\n","import { useEffect } from \"react\";\n\nexport function useEffectTimeout(\n  effect: React.EffectCallback,\n  deps: React.DependencyList,\n  timeout: number = 1000,\n) {\n  useEffect(() => {\n    const timeoutId = setTimeout(effect, timeout);\n\n    return () => clearTimeout(timeoutId);\n  }, deps);\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\n\nconst WebPlaybackSDKReadyContext = createContext<boolean | undefined>(undefined);\n\nexport const WebPlaybackSDKReadyProvider: React.FC = ({ children }) => {\n  const [webPlaybackSDKReady, setWebPlaybackSDKReady] = useState(false);\n\n  useEffect(() => {\n    window.onSpotifyWebPlaybackSDKReady = () => {\n      setWebPlaybackSDKReady(true);\n    };\n  }, []);\n\n  return (\n    <WebPlaybackSDKReadyContext.Provider value={webPlaybackSDKReady}>\n      {children}\n    </WebPlaybackSDKReadyContext.Provider>\n  );\n};\n\nexport function useWebPlaybackSDKReady() {\n  const value = useContext(WebPlaybackSDKReadyContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, {\n  createContext,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useEffectTimeout } from \"./useEffectTimeout\";\nimport { useWebPlaybackSDKReady } from \"./webPlaybackSDKReady\";\n\nconst PlayerContext = createContext<Spotify.Player | null | undefined>(undefined);\n\ntype ProviderProps = {\n  deviceName: Spotify.PlayerInit[\"name\"];\n  getOAuthToken: Spotify.PlayerInit[\"getOAuthToken\"];\n  volume?: Spotify.PlayerInit[\"volume\"];\n  connectOnInitialized: boolean;\n};\n\nexport const SpotifyPlayerProvider: React.FC<ProviderProps> = ({\n  children,\n  deviceName,\n  getOAuthToken,\n  volume,\n  connectOnInitialized,\n}) => {\n  const [player, setPlayer] = useState<Spotify.Player | null>(null);\n  const webPlaybackSDKReady = useWebPlaybackSDKReady();\n\n  // create Spotify.Player instance.\n  useEffect(\n    () => {\n      if (webPlaybackSDKReady) {\n        const player = new Spotify.Player({\n          name: deviceName,\n          getOAuthToken: getOAuthToken,\n          volume: volume,\n        });\n\n        setPlayer(player);\n\n        if (connectOnInitialized) {\n          player.connect();\n        }\n\n        return () => player.disconnect();\n      }\n    },\n    // `deviceName` and `volume` are intentionally not passed.\n    // When they are changed, they will be applied with the following useUpdateEffect.\n    [getOAuthToken, connectOnInitialized, webPlaybackSDKReady],\n  );\n\n  // The first effect is ignored.\n  // Because the first `deviceName` will be passed to Spotify.Player constructor.\n  useEffectTimeout(() => {\n    player?.setName(deviceName);\n  }, [deviceName]);\n\n  // The first effect is ignored.\n  // Because the first `volume` will be passed to Spotify.Player constructor.\n  useEffect(() => {\n    volume !== undefined && player?.setVolume(volume);\n  }, [volume]);\n\n  return <PlayerContext.Provider value={player} children={children} />;\n};\n\nexport type SpotifyPlayer = Omit<\n  Spotify.Player,\n  | \"addListener\"\n  | \"on\"\n  | \"removeListener\"\n  | \"setName\"\n  | \"setVolume\"\n  | \"_options\"\n  | \"getVolume\"\n>;\n\nexport function useSpotifyPlayer(): SpotifyPlayer | null {\n  const value = useContext(PlayerContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  const player = useMemo<SpotifyPlayer | null>(() => {\n    if (value === null) return null;\n\n    return {\n      connect: () => value.connect(),\n      disconnect: () => value.disconnect(),\n      getCurrentState: () => value.getCurrentState(),\n      nextTrack: () => value.nextTrack(),\n      pause: () => value.pause(),\n      previousTrack: () => value.previousTrack(),\n      resume: () => value.resume(),\n      seek: pos_ms => value.seek(pos_ms),\n      togglePlay: () => value.togglePlay(),\n    };\n  }, [value]);\n\n  return player;\n}\n\nexport function useSpotifyPlayerRawInstance() {\n  const value = useContext(PlayerContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nexport type PlayerDevice = Spotify.WebPlaybackInstance & {\n  status: \"ready\" | \"not_ready\";\n};\n\nconst DeviceContext = createContext<PlayerDevice | null | undefined>(undefined);\n\nexport const DeviceProvider: React.FC = ({ children }) => {\n  const [device, setDevice] = useState<PlayerDevice | null>(null);\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const ready = (device: Spotify.WebPlaybackInstance) => {\n      setDevice({ ...device, status: \"ready\" });\n    };\n\n    const notReady = (device: Spotify.WebPlaybackInstance) => {\n      setDevice({ ...device, status: \"not_ready\" });\n    };\n\n    player.addListener(\"ready\", ready);\n    player.addListener(\"not_ready\", notReady);\n\n    return () => {\n      player.removeListener(\"ready\", ready);\n      player.removeListener(\"not_ready\", notReady);\n    };\n  }, [player]);\n\n  return <DeviceContext.Provider value={device} children={children} />;\n};\n\nexport function usePlayerDevice() {\n  const value = useContext(DeviceContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nexport type ErrorState = Spotify.Error & { type: Spotify.ErrorTypes };\n\nconst ErrorStateContext = createContext<ErrorState | null | undefined>(undefined);\n\nexport const ErrorStateProvider: React.FC = ({ children }) => {\n  const [errorState, setErrorState] = useState<ErrorState | null>(null);\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const onInitializationError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"initialization_error\" });\n    };\n\n    const onAuthenticationError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"authentication_error\" });\n    };\n\n    const onAccountError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"account_error\" });\n    };\n\n    const onPlaybackError = (error: Spotify.Error) => {\n      setErrorState({ ...error, type: \"playback_error\" });\n    };\n\n    player.addListener(\"initialization_error\", onInitializationError);\n    player.addListener(\"authentication_error\", onAuthenticationError);\n    player.addListener(\"account_error\", onAccountError);\n    player.addListener(\"playback_error\", onPlaybackError);\n\n    return () => {\n      player.removeListener(\"initialization_error\", onInitializationError);\n      player.removeListener(\"authentication_error\", onAuthenticationError);\n      player.removeListener(\"account_error\", onAccountError);\n      player.removeListener(\"playback_error\", onPlaybackError);\n    };\n  }, [player]);\n\n  return <ErrorStateContext.Provider value={errorState} children={children} />;\n};\n\nexport function useErrorState() {\n  const value = useContext(ErrorStateContext);\n\n  if (value === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  return value;\n}\n","import React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { MUST_BE_WRAPPED_MESSAGE } from \"./constant\";\nimport { useSpotifyPlayerRawInstance } from \"./spotifyPlayer\";\n\nconst PlaybackStateContext = createContext<Spotify.PlaybackState | null | undefined>(\n  undefined,\n);\n\nexport const PlaybackStateProvider: React.FC = ({ children }) => {\n  const [playbackState, setPlaybackState] = useState<Spotify.PlaybackState | null>(\n    null,\n  );\n\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => {\n    if (player === null) return;\n\n    const playerStateChanged = (state: Spotify.PlaybackState) => {\n      setPlaybackState(state);\n    };\n\n    player.addListener(\"player_state_changed\", playerStateChanged);\n\n    return () => player.removeListener(\"player_state_changed\", playerStateChanged);\n  }, [player]);\n\n  return <PlaybackStateContext.Provider value={playbackState} children={children} />;\n};\n\nexport function usePlaybackState(interval?: false): Spotify.PlaybackState | null;\nexport function usePlaybackState(\n  interval: true,\n  durationMS?: number,\n): Spotify.PlaybackState | null;\nexport function usePlaybackState(\n  interval?: boolean,\n  durationMS = 1000,\n): Spotify.PlaybackState | null {\n  const fromContext = useContext(PlaybackStateContext);\n\n  if (fromContext === undefined) throw new Error(MUST_BE_WRAPPED_MESSAGE);\n\n  const [playbackState, setPlaybackState] = useState(fromContext);\n\n  const player = useSpotifyPlayerRawInstance();\n\n  useEffect(() => setPlaybackState(fromContext), [fromContext]);\n\n  const playbackStateIsNull = playbackState === null;\n  useEffect(() => {\n    if (!interval) return;\n    if (player === null) return;\n    if (playbackStateIsNull) return;\n\n    if (playbackState!.paused) return;\n\n    const intervalId = window.setInterval(async () => {\n      const newState = await player.getCurrentState();\n      setPlaybackState(newState);\n    }, durationMS);\n\n    return () => window.clearInterval(intervalId);\n  }, [interval, player, playbackStateIsNull, playbackState?.paused, durationMS]);\n\n  return playbackState;\n}\n","import React, { useEffect } from \"react\";\nimport { SPOTIFY_WEB_PLAYBACK_SDK_URL } from \"./constant\";\nimport { DeviceProvider } from \"./device\";\nimport { ErrorStateProvider } from \"./errorState\";\nimport { PlaybackStateProvider } from \"./playbackState\";\nimport { SpotifyPlayerProvider } from \"./spotifyPlayer\";\nimport { WebPlaybackSDKReadyProvider } from \"./webPlaybackSDKReady\";\n\nexport type WebPlaybackSDKProps = {\n  deviceName: Spotify.PlayerInit[\"name\"];\n  getOAuthToken: Spotify.PlayerInit[\"getOAuthToken\"];\n  volume?: Spotify.PlayerInit[\"volume\"];\n  connectOnInitialized?: boolean;\n};\n\nexport const WebPlaybackSDK: React.FC<WebPlaybackSDKProps> = ({\n  children,\n  deviceName,\n  getOAuthToken,\n  volume,\n  connectOnInitialized = true,\n}) => {\n  useEffect(() => {\n    // load Web Playback SDK.\n    const script = document.createElement(\"script\");\n    script.src = SPOTIFY_WEB_PLAYBACK_SDK_URL;\n    document.body.appendChild(script);\n\n    return () => {\n      document.body.removeChild(script);\n    };\n  }, []);\n\n  return (\n    <WebPlaybackSDKReadyProvider>\n      <SpotifyPlayerProvider\n        deviceName={deviceName}\n        getOAuthToken={getOAuthToken}\n        volume={volume}\n        connectOnInitialized={connectOnInitialized}>\n        <PlaybackStateProvider>\n          <DeviceProvider>\n            <ErrorStateProvider>{children}</ErrorStateProvider>\n          </DeviceProvider>\n        </PlaybackStateProvider>\n      </SpotifyPlayerProvider>\n    </WebPlaybackSDKReadyProvider>\n  );\n};\n"],"names":["MUST_BE_WRAPPED_MESSAGE","SPOTIFY_WEB_PLAYBACK_SDK_URL","useEffectTimeout","effect","deps","timeout","useEffect","timeoutId","setTimeout","clearTimeout","WebPlaybackSDKReadyContext","createContext","undefined","WebPlaybackSDKReadyProvider","children","useState","webPlaybackSDKReady","setWebPlaybackSDKReady","window","onSpotifyWebPlaybackSDKReady","React","Provider","value","useWebPlaybackSDKReady","useContext","Error","PlayerContext","SpotifyPlayerProvider","deviceName","getOAuthToken","volume","connectOnInitialized","player","setPlayer","Spotify","Player","name","connect","disconnect","setName","setVolume","useSpotifyPlayer","useMemo","getCurrentState","nextTrack","pause","previousTrack","resume","seek","pos_ms","togglePlay","useSpotifyPlayerRawInstance","DeviceContext","DeviceProvider","device","setDevice","ready","status","notReady","addListener","removeListener","usePlayerDevice","ErrorStateContext","ErrorStateProvider","errorState","setErrorState","onInitializationError","error","type","onAuthenticationError","onAccountError","onPlaybackError","useErrorState","PlaybackStateContext","PlaybackStateProvider","playbackState","setPlaybackState","playerStateChanged","state","usePlaybackState","interval","durationMS","fromContext","playbackStateIsNull","paused","intervalId","setInterval","newState","clearInterval","WebPlaybackSDK","script","document","createElement","src","body","appendChild","removeChild"],"mappings":"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"}